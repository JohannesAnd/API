DROP DATABASE IF EXISTS cars;
CREATE DATABASE IF NOT EXISTS cars;
USE cars;

CREATE TABLE IF NOT EXISTS Users(
    id INT NOT NULL,
	is_admin BOOL,
	name VARCHAR(40) NOT NULL,
	password VARCHAR(50) NOT NULL,
	PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS Organizations(
    id INT AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL,
    PRIMARY KEY(id)
);

CREATE TABLE IF NOT EXISTS Cars(
    registration VARCHAR(10) NOT NULL,
    make VARCHAR(20),
    type VARCHAR(30),
    prodYear INT,
    organization_id INT NOT NULL,
    FOREIGN KEY(organization_id) REFERENCES Organizations(id),
    PRIMARY KEY(registration)
);

CREATE TABLE IF NOT EXISTS OrgMembers(
    user_id INT NOT NULL,
    org_id INT NOT NULL,
    role VARCHAR(10) NOT NULL,
    FOREIGN KEY(user_id) REFERENCES Users(id),
    FOREIGN KEY(org_id) REFERENCES Organizations(id),
    PRIMARY KEY(user_id, org_id)
);


CREATE TABLE IF NOT EXISTS Trips(
    id VARCHAR(100) NOT NULL,
    car_id VARCHAR(10) NOT NULL,
    user_id INT,
    start_time DATETIME(3) NOT NULL,
    PRIMARY KEY(id),
    FOREIGN KEY(user_id) REFERENCES Users(id),
    FOREIGN KEY(car_id) REFERENCES Cars(registration)
);

CREATE TABLE IF NOT EXISTS TripVertices(
    trip_id VARCHAR(100) NOT NULL,
    longitude DOUBLE,
    latitude DOUBLE,
    speed DOUBLE,
    altitude DOUBLE,
    coolant_temp DOUBLE,
    engine_load DOUBLE,
    fuel_pressure DOUBLE,
    intake_air_temp DOUBLE,
    rpm INT,
    error_msg VARCHAR(1000),
    registration_time DATETIME(3) NOT NULL,
    FOREIGN KEY(trip_id) REFERENCES Trips(id),
    PRIMARY KEY(trip_id, registration_time)
);

INSERT INTO Users VALUES(346372, true, "Admin", "1234");
INSERT INTO Users VALUES(374759, false, "Gunnar", "1234");
INSERT INTO Users VALUES(123456, false, "Lars", "1234");
INSERT INTO Organizations VALUES(null, "MinOrg");
INSERT INTO Cars VALUES("EN12325", "Lada", "Shitwagon", 1839, 1);
INSERT INTO Cars VALUES("EN53325", "Lada", "Snailmobile", 1019, 1);
INSERT INTO OrgMembers VALUES(374759, 1, "Member");
INSERT INTO OrgMembers VALUES(123456, 1, "Member");
INSERT INTO Trips VALUES("TRIP 0001", "EN12325", 374759, "2016-04-08 13:51:04.777");
INSERT INTO TripVertices VALUES("TRIP 0001", 10.396087, 63.419168, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 13:51:04.777");
INSERT INTO TripVertices VALUES("TRIP 0001", 10.395633, 63.420146, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 13:51:06.777");
INSERT INTO TripVertices VALUES("TRIP 0001", 10.395108, 63.421143, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 13:51:08.777");
INSERT INTO TripVertices VALUES("TRIP 0001", 10.394765, 63.421892, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 13:51:10.777");
INSERT INTO TripVertices VALUES("TRIP 0001", 10.394851, 63.422194, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 13:51:12.777");
INSERT INTO TripVertices VALUES("TRIP 0001", 10.395463, 63.422199, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 13:51:14.777");
INSERT INTO TripVertices VALUES("TRIP 0001", 10.395763, 63.422156, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 13:51:16.777");
INSERT INTO TripVertices VALUES("TRIP 0001", 10.395967, 63.422396, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 13:51:18.777");
INSERT INTO Trips VALUES("TRIP 0002", "EN12325", 374759, "2016-04-08 17:00:04.777");
INSERT INTO TripVertices VALUES("TRIP 0002", 10.395967, 63.422396, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:04.777");
INSERT INTO TripVertices VALUES("TRIP 0002", 10.396160, 63.422622, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:06.777");
INSERT INTO TripVertices VALUES("TRIP 0002", 10.395688, 63.422680, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:08.777");
INSERT INTO TripVertices VALUES("TRIP 0002", 10.394604, 63.422814, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:10.777");
INSERT INTO TripVertices VALUES("TRIP 0002", 10.394314, 63.423136, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:12.777");
INSERT INTO TripVertices VALUES("TRIP 0002", 10.394164, 63.423683, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:14.777");
INSERT INTO TripVertices VALUES("TRIP 0002", 10.393992, 63.424264, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:16.777");
INSERT INTO TripVertices VALUES("TRIP 0002", 10.393906, 63.424710, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:18.777");
INSERT INTO Trips VALUES("TRIP 0005", "EN12325", 374759, "2016-04-08 17:00:04.777");
INSERT INTO TripVertices VALUES("TRIP 0005", 10.395967, 63.422396, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:04.777");
INSERT INTO TripVertices VALUES("TRIP 0005", 10.396160, 63.422622, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:06.777");
INSERT INTO TripVertices VALUES("TRIP 0005", 10.395688, 63.422680, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:08.777");
INSERT INTO TripVertices VALUES("TRIP 0005", 10.394604, 63.422814, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:10.777");
INSERT INTO TripVertices VALUES("TRIP 0005", 10.394314, 63.423136, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:12.777");
INSERT INTO TripVertices VALUES("TRIP 0005", 10.394164, 63.423683, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:14.777");
INSERT INTO TripVertices VALUES("TRIP 0005", 10.393992, 63.424264, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:16.777");
INSERT INTO TripVertices VALUES("TRIP 0005", 10.393906, 63.424710, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:18.777");
INSERT INTO Trips VALUES("TRIP 0006", "EN12325", 374759, "2016-04-08 17:00:04.777");
INSERT INTO TripVertices VALUES("TRIP 0006", 10.395967, 63.422396, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:04.777");
INSERT INTO TripVertices VALUES("TRIP 0006", 10.396160, 63.422622, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:06.777");
INSERT INTO TripVertices VALUES("TRIP 0006", 10.395688, 63.422680, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:08.777");
INSERT INTO TripVertices VALUES("TRIP 0006", 10.394604, 63.422814, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:10.777");
INSERT INTO TripVertices VALUES("TRIP 0006", 10.394314, 63.423136, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:12.777");
INSERT INTO TripVertices VALUES("TRIP 0006", 10.394164, 63.423683, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:14.777");
INSERT INTO TripVertices VALUES("TRIP 0006", 10.393992, 63.424264, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:16.777");
INSERT INTO TripVertices VALUES("TRIP 0006", 10.393906, 63.424710, 40.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 17:00:18.777");
INSERT INTO Trips VALUES("TRIP 0003", "EN53325", 123456, "2016-04-08 16:51:04.777");
INSERT INTO TripVertices VALUES("TRIP 0003", 10.396683, 63.404492, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 16:51:04.777");
INSERT INTO TripVertices VALUES("TRIP 0003", 10.395739, 63.402340, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 16:51:06.777");
INSERT INTO TripVertices VALUES("TRIP 0003", 10.395223, 63.401310, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 16:51:08.777");
INSERT INTO TripVertices VALUES("TRIP 0003", 10.394729, 63.400191, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 16:51:10.777");
INSERT INTO TripVertices VALUES("TRIP 0003", 10.394075, 63.399091, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 16:51:12.777");
INSERT INTO TripVertices VALUES("TRIP 0003", 10.393335, 63.398130, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 16:51:14.777");
INSERT INTO TripVertices VALUES("TRIP 0003", 10.392294, 63.397011, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 16:51:16.777");
INSERT INTO TripVertices VALUES("TRIP 0003", 10.390374, 63.395536, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 16:51:18.777");
INSERT INTO Trips VALUES("TRIP 0004", "EN53325", 123456, "2016-04-08 19:32:04.777");
INSERT INTO TripVertices VALUES("TRIP 0004", 10.390653, 63.395493, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 19:32:04.777");
INSERT INTO TripVertices VALUES("TRIP 0004", 10.391908, 63.396444, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 19:32:06.777");
INSERT INTO TripVertices VALUES("TRIP 0004", 10.393002, 63.397381, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 19:32:08.777");
INSERT INTO TripVertices VALUES("TRIP 0004", 10.393828, 63.398342, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 19:32:10.777");
INSERT INTO TripVertices VALUES("TRIP 0004", 10.394482, 63.399288, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 19:32:12.777");
INSERT INTO TripVertices VALUES("TRIP 0004", 10.395018, 63.400316, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 19:32:14.777");
INSERT INTO TripVertices VALUES("TRIP 0004", 10.395637, 63.401593, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 19:32:16.777");
INSERT INTO TripVertices VALUES("TRIP 0004", 10.396184, 63.402789, 100.0, 20.0, 80.0, 30.0, 10000.0, 30.0, 2300, "", "2016-04-08 19:32:18.777");
